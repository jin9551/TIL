# AWS 범용 버킷과 디렉터리 버킷

AWS S3에는 **General Purpose 버킷**과 **Directory 버킷**(일명 S3 Express One Zone)이란 두 가지 유형이 있으며, 각각 목적과 아키텍처가 다릅니다. 아래에 핵심 차이점을 정리할게요.

---

## S3 General Purpose 버킷

* **기본 S3 버킷 유형**입니다. 객체를 여러 AZ에 복제 저장하여 높은 내구성과 가용성을 제공하죠.
* **글로벌 버킷 이름**: 생성할 때 전 세계에서 고유한 이름이어야 하며, 리전 단위로 존재합니다. ([Medium][1])
* **폴더 구조는 가상의 표현**: 경로 구분자는 실제 디렉터리가 아니라 오브젝트 key 안에 포함된 프리픽스로 처리됩니다. 이 때문에 “폴더”는 UI상의 편의이고, 실제로는 객체 key가 전부입니다. ([Stack Overflow][2], [Reddit][3])

---

## Directory 버킷 (S3 Express One Zone 기반)

* **저지연성 및 특정 AZ 내 고성능** 요건에 맞춘 버킷입니다. 한 AZ에만 저장돼 있어 \*\*지연(latency)\*\*이 줄어들고 성능이 크게 향상됩니다. ([Medium][1], [더레지스터][4])
* **계층적 디렉터리 구조**를 실제처럼 제공합니다. `"dir1/dir2/file.txt"`일 때 `dir1/`과 `dir1/dir2/`가 디렉터리로 처리됩니다. ([AWS 문서][5])
* **TPS(초당 요청 처리량)**:

  * General은 prefix 기준 확장.
  * Directory는 버킷 단위로 즉시 높은 TPS가 제공됩니다. ([더레지스터][4])
* **인증 방식**: 세션 기반 인증을 활용해 인증 지연을 줄입니다. IAM 정책보다 빠른 접근 가능. ([enterprisedt.com][6])

---

## Directory 버킷의 제한 사항

Directory 버킷은 성능 중심 설계로 일부 기능이 제한됩니다: ([AWS 문서][7])

* 태그, 버전 관리, 수명주기(Lifecycle), 레플리케이션, 이벤트 알림, KMS 암호화, Object Lock, PrivateLink, 정적 웹 호스팅 등 지원 안 됨.
* 비활성 상태로 들어갈 수 있음: 90일 동안 요청 없으면 일시적으로 접근 불가 → 활성화까지 몇 분 대기(503 에러). ([더레지스터][4], [AWS 문서][5])
* ETag는 MD5가 아닌 랜덤값이며, multipart 업로드 처리 방식도 조금 다릅니다. ([AWS 문서][7])

---

## 비교 요약 표

| 항목      | General Purpose 버킷  | Directory 버킷 (Express One Zone) |
| ------- | ------------------- | ------------------------------- |
| 저장 위치   | 여러 AZ에 복제           | 단일 AZ                           |
| 구조      | 평면 구조 (프리픽스로 폴더 흉내) | 실제 계층적 디렉터리                     |
| 성능(TPS) | Prefix 기반 자동 확장     | 버킷 단위로 즉시 고성능                   |
| 인증 방식   | IAM 기반              | 세션 기반 토큰 인증                     |
| 지원 기능   | 거의 모든 S3 기능 지원      | 태그, 버전관리, 암호화 등 제한 다수           |
| 비활성화 시  | 없음                  | 90일 후 비활성 → 접근 지연 발생            |

---

## 언제 어떤 버킷을 쓸까?

* **일반적인 워크로드, 다양한 데이터 저장 및 S3 기능 활용이 필요**하다면 → **General Purpose**.
* **저지연, 높은 TPS가 핵심이고, AZ 내 워크로드로 간소한 구조면 충분**하다면 → **Directory 버킷**이 유리합니다.


# 폴더 구조는 가상의 표현: 경로 구분자는 실제 디렉터리가 아니라 오브젝트 key 안에 포함된 프리픽스로 처리됩니다. 이 때문에 “폴더”는 UI상의 편의이고, 실제로는 객체 key가 전부입니다

# Q. 이게 무슨 소리야?

좋아요, 이 부분은 처음 접하면 헷갈리기 쉬운 개념이라
\*\*“S3에 폴더라는 건 없다”\*\*는 말이 무슨 의미인지 예시와 함께 풀어서 설명드릴게요.

---

## 1. 로컬 파일 시스템 vs. S3

* **로컬 PC/리눅스 디렉터리**

  * 물리적으로 디렉터리(폴더)가 존재하고, 그 안에 파일이 들어 있음.
  * `/photos/2025/img1.jpg`라면 `photos` 폴더와 `2025` 폴더가 실제로 디스크 상에 존재.

* **S3**

  * 디렉터리라는 물리적 개념이 없음.
  * S3는 **버킷 안에 "Key(문자열)"로만** 객체를 구분.
  * Key 안에 `/`(슬래시)가 들어가면 콘솔(UI)에서 폴더처럼 보이도록 **시각적으로 흉내**내는 것뿐.

---

## 2. 예시로 보는 가짜 폴더

### 객체 Key

```
my-bucket
  ├── photos/2025/img1.jpg
  ├── photos/2025/img2.jpg
  └── photos/2024/img3.jpg
```

S3 내부 저장 구조는 이렇게 되어 있는 게 아니라,
다음과 같이 단순 **Key 목록**으로만 존재합니다.

| Key                  | Size | Last Modified |
| -------------------- | ---- | ------------- |
| photos/2025/img1.jpg | 2MB  | 2025-08-01    |
| photos/2025/img2.jpg | 3MB  | 2025-08-02    |
| photos/2024/img3.jpg | 1MB  | 2025-07-31    |

* 여기서 **`photos/`나 `2025/`라는 폴더는 실제로 없어요.**
* 단지 Key 안에 `/` 문자가 들어가 있으니, AWS 콘솔이 그걸 폴더처럼 묶어서 보여주는 것뿐.

---

## 3. 폴더를 삭제했을 때의 차이

* 로컬이라면 `rm -rf photos/2025` 하면 폴더와 안의 파일이 사라짐.
* S3에서는 `"photos/2025/"`로 시작하는 **모든 Key를 삭제**하는 것일 뿐.
* 폴더 자체는 물리적으로 없으니 “빈 폴더”라는 개념도 없음.

  * AWS 콘솔에서 “빈 폴더 만들기” 하면 실제로는 `photos/2025/`라는 **0바이트짜리 객체**를 만들어서 흉내냅니다.

---

## 4. 왜 이렇게 했나?

* S3는 **객체 스토리지**라서, 파일 시스템처럼 디렉터리 구조를 유지할 필요가 없음.
* 대신 Key 네임스페이스가 평면(Flat)이어서 확장성이 무한대.
* `/`는 단순히 문자열의 일부일 뿐이라, 프리픽스(prefix)로 쿼리하면 특정 "폴더"처럼 동작 가능.

---

## 5. 확인 방법

AWS CLI로 보면 바로 드러납니다.

```bash
aws s3api list-objects-v2 --bucket my-bucket
```

→ 출력 결과에는 `photos/2025/img1.jpg` 같은 **Key 문자열**만 있고, 폴더라는 엔트리는 없음.

---

즉,

> “S3의 폴더는 가짜다” = S3는 **Key 문자열을 `/`로 구분해서 계층처럼 보이게 하는 것일 뿐, 실제 디렉터리 구조가 없다**는 뜻입니다.

---
